<h1>
  <%= link_to "#{@contact.first_name if @appointment.appointable_type == 'Contact'}
    #{@contact.last_name if @appointment.appointable_type == 'Contact'}", contact_path(@contact) if @appointment.appointable_type == 'Contact' %>
  <%= link_to "#{@project.name if @appointment.appointable_type == 'Project'}", project_path(@project) if @appointment.appointable_type == 'Project' %>
  <%= " | #{@appointment.name.capitalize}" %>
</h1>
<p><%= @appointment.starts_at %></p>
<p><%= @appointment.description %></p>
<p><%= @appointment.full_address unless @appointment.street1.nil? || @appointment.city.nil? || @appointment.state.nil? %></p>
<p><%= @appointment.city if @appointment.street1.nil? %> <%= ", #{@appointment.state}" unless @appointment.state.nil? %> <%= @appointment.zipcode unless @appointment.zipcode.nil? %></p>

<div id="map_canvas"></div>

<%= link_to 'Back', :back %>
<%= link_to 'Edit', edit_appointment_path(@appointment) %>
<%= link_to 'Delete', appointment_path(@appointment), method: :delete, data: { confirm: 'Are you sure?' } %>




<script src="https://maps.googleapis.com/maps/api/js"></script>
<script>
  var bittersMap = (function () {
    var myLatlng = new google.maps.LatLng(<%= @appointment.latitude%>, <%= @appointment.longitude %>),
        mapCenter = new google.maps.LatLng(<%= @appointment.latitude%>, <%= @appointment.longitude %>),
        mapCanvas = document.getElementById('map_canvas'),
        mapOptions = {
          center: mapCenter,
          zoom: 10,
          scrollwheel: true,
          draggable: true,
          disableDefaultUI: false,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        },
        map = new google.maps.Map(mapCanvas, mapOptions),
        contentString =
          '<div id="content">'+
          '<div id="siteNotice">'+
          '</div>'+
          '<h1 id="firstHeading" class="firstHeading">thoughtbot</h1>'+
          '<div id="bodyContent"'+
          '<p>Sveav√§gen 98</p>'+
          '</div>'+
          '</div>',
        infowindow = new google.maps.InfoWindow({
          content: contentString,
          maxWidth: 300
        }),
        marker = new google.maps.Marker({
          position: myLatlng,
          map: map,
          title: 'Default Location'
        });

    return {
      init: function () {
        map.set('styles', [{
          featureType: 'landscape',
          elementType: 'geometry',
          stylers: [
            { hue: '#ffff00' },
            { saturation: 30 },
            { lightness: 10}
          ]}
        ]);

        google.maps.event.addListener(marker, 'click', function () {
          infowindow.open(map,marker);
        });
      }
    };
  }());

  bittersMap.init();
</script>

